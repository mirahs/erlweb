{% extends "view_base.html" %}

{% block body %}
<div class="container">
    <form class="layui-form" method="get">
        <div class="layui-form-item">
            <div class="layui-inline">
                <div class="layui-input-inline" style="width: 100px;">
                    <input type="text" name="account" placeholder="账号" autocomplete="off" class="layui-input" value="{{ account }}">
                </div>
            </div>
            <div class="layui-inline">
                <div class="layui-input-inline">
                    <button class="layui-btn">搜索</button>
                </div>
            </div>
        </div>
    </form>

    <table class="layui-table">
        <thead>
        <tr>
            <th>登录账号</th>
            <th>登录时间</th>
            <th>登录状态</th>
            <th>登录IP地址</th>
            <th>登录IP段</th>
            <th>登录位置</th>
            <th>功能</th>
        </tr>
        </thead>
        <tbody>
        {% for data in datas %}
        <tr>
            <td>{{ data.account }}</td>
            <td>{% ymdhis data.time %}</td>
            <td>{{ data.status_desc }}</td>
            <td>{{ data.ip }}</td>
            <td>{{ data.ip_segment }}</td>
            <td>{{ data.address }}</td>
            <td>
                <a class="layui-btn layui-btn-danger layui-btn-xs" href="?act=del&id={{ data.id }}">删除</a>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    <div id="page"></div>
</div>
{% endblock %}


{% block body_js %}
<script src="{% web_static_url %}layui/layui.js"></script>
<script type="text/javascript">
    layui.use(['laypage'], function () {
        const laypage = layui.laypage;


        laypage.render({
            elem: 'page' //这里的 page 是 ID，不用加 # 号
            ,count: '{{ page.count }}' //数据总数
            ,curr: '{{ page.curr }}' //当前页
            ,limit: '{{ page.limit }}' //每页显示的条数
            ,layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']
            ,jump: function (obj, first){
                // obj包含了当前分页的所有参数，比如：
                // console.log(obj.curr);  //得到当前页，以便向服务端请求对应页的数据。
                // console.log(obj.limit); //得到每页显示的条数
                // 首次不执行,使用原始的curr,后面需要自己通过回传来更新
                if (!first) {
                    location.href='?page=' + obj.curr + '&limit=' + obj.limit + '{{ page.query }}';
                }
            }
        });
    });
</script>
{% endblock %}
